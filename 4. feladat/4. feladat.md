# üìè IR vs Ultrahangos T√°vols√°gm√©r√©s ‚Äì Arduino Projekt

Ebben a projektben k√©t n√©pszer≈± t√°vols√°gm√©r≈ë szenzort hasonl√≠tunk √∂ssze: egy **IR t√°vols√°gm√©r≈ët** (pl. Sharp GP2Y0A) √©s az **ultrahangos HC-SR04-et**. A c√©l a t√°vols√°gm√©r√©s megval√≥s√≠t√°sa, pontoss√°g n√∂vel√©se, valamint LED-f√©nyer≈ë szab√°lyoz√°sa a m√©rt √©rt√©k alapj√°n.

---

## üß∞ Alkatr√©szek

| Eszk√∂z             | Megjegyz√©s                     |
|--------------------|--------------------------------|
| Arduino UNO        |                                |
| HC-SR04 szenzor    | Ultrahangos                    |
| IR t√°vols√°gm√©r≈ë    | Pl. Sharp GP2Y0A21YK0F         |
| LCD kijelz≈ë (opci√≥) | Vagy soros port               |
| LED + ellen√°ll√°s   | F√©nyer≈ëszab√°lyoz√°shoz          |
| Breadboard + k√°belek|                               |

---

## üîå Bek√∂t√©si √°bra

![8x8 matrix connecting diagram](/4.%20feladat/4-1.png)

> √Åbra: A HC-SR04 bek√∂t√©se ‚Äì Trig (kimenet), Echo (bemenet); 

---

## üî¨ Projekt l√©p√©sek

### 1. HC-SR04 szenzor haszn√°lata

```cpp
int trig = 9;
int echo = 10;
long ido;
float tavolsag;

void setup() {
  Serial.begin(9600);
  pinMode(trig, OUTPUT);
  pinMode(echo, INPUT);
}

void loop() {
  digitalWrite(trig, LOW);
  delayMicroseconds(2);
  digitalWrite(trig, HIGH);
  delayMicroseconds(10);
  digitalWrite(trig, LOW);

  ido = pulseIn(echo, HIGH);
  tavolsag = ido * 0.034 / 2;

  Serial.print("Tavolsag: ");
  Serial.print(tavolsag);
  Serial.println(" cm");

  delay(200);
}
```

> [!NOTE]
> Az ido * 0.034 / 2 k√©plet a hang terjed√©si sebess√©g√©b≈ël ad√≥dik. A m√©rt impulzushossz a visszaver≈ëd√∂tt jel alapj√°n sz√°m√≠t√≥dik.
---

### 2. IR szenzor haszn√°lata (anal√≥g)

![8x8 matrix connecting diagram](/4.%20feladat/4-2.png)

> √Åbra: A IR sensor bek√∂t√©se ‚Äì digit√°lis bemenetre. 



```cpp
int irPin = A0;
int ertek;
float tavolsag;

void loop() {
  ertek = analogRead(irPin);
  tavolsag = 12343.85 * pow(ertek, -1.15);  // k√∂zel√≠t≈ë k√©plet
  Serial.print("IR tavolsag: ");
  Serial.print(tavolsag);
  Serial.println(" cm");
  delay(200);
}
```
>[!NOTE]
>Az IR szenzor nem line√°ris, de a fenti k√©plet egyes t√≠pusokhoz (pl. Sharp GP2Y0A21YK0F) j√≥ k√∂zel√≠t√©st ad 10‚Äì80 cm k√∂z√∂tt.
---
### 3. Pontos√≠t√°s: √Åtlagol√°s t√∂bb m√©r√©sb≈ël
```cpp
float atlagoltTavolsag() {
  float osszeg = 0;
  for (int i = 0; i < 5; i++) {
    osszeg += mertesHC_SR04();
    delay(50);
  }
  return osszeg / 5;
}
```

> [!NOTE]
> Egyszer≈± √°tlagol√°ssal kisz≈±rhet≈ëk v√©letlenszer≈± hib√°k, de mozg√≥√°tlaggal m√©g stabilabb √©rt√©ket kaphatunk.
---
### 4. Mozg√≥√°tlag implement√°l√°sa
```cpp
#define MERET 5
float ertekek[MERET];
int index = 0;

float mozgoAtlag(float uj) {
  ertekek[index] = uj;
  index = (index + 1) % MERET;

  float osszeg = 0;
  for (int i = 0; i < MERET; i++) {
    osszeg += ertekek[i];
  }
  return osszeg / MERET;
}
```
> [!NOTE]
> A mozg√≥√°tlag "cs√∫sz√≥ablakk√©nt" m≈±k√∂dik, amely folyamatosan friss√ºl √©s kiegyenl√≠ti a hirtelen kiugr√°sokat.
---



### 5. Extra: Kijelz≈ën a m√©rt adatok megjelen√≠t√©se


![8x8 matrix connecting diagram](/4.%20feladat/4-3.png)

> √Åbra: Kijelz≈ëvel eg√©sz√≠tj√ºk ki az √°ramk√∂r√ºnket!




```cpp
#include <LiquidCrystal.h>

LiquidCrystal kijelzo(12, 11, 5, 4, 3, 2); // RS, E, D4, D5, D6, D7
int trig = 9;
int echo = 10;
long ido;
float tavolsag;

void setup() {
  kijelzo.begin(8, 2);
  pinMode(trig, OUTPUT);
  pinMode(echo, INPUT);
}

void loop() {
  // T√°vols√°g m√©r√©se
  digitalWrite(trig, LOW);
  delayMicroseconds(2);
  digitalWrite(trig, HIGH);
  delayMicroseconds(10);
  digitalWrite(trig, LOW);

  ido = pulseIn(echo, HIGH);
  tavolsag = ido * 0.034 / 2;

  // Kijelz≈ë friss√≠t√©se
  kijelzo.clear();
  kijelzo.setCursor(0, 0);
  kijelzo.print("Tav:");
  kijelzo.print((int)tavolsag);
  kijelzo.print("cm");

  delay(500);
}

```
> [!NOTE]
> A kijelzo.clear() minden ciklusban t√∂rli a kijelz≈ët ‚Äì ez villog√°st okozhat. Helyette haszn√°lhatsz fix poz√≠ci√≥ra √≠r√°st √©s kor√°bbi karakterek fel√ºl√≠r√°s√°t.
Ha I2C LCD-t haszn√°lsz, a LiquidCrystal_I2C k√∂nyvt√°rat √©s kijelzo.init(); / kijelzo.backlight(); h√≠v√°sokat kell haszn√°lni a begin() helyett.

 ## üìà Fejleszt√©si √∂tletek
- LCD kijelz≈ëre is ki√≠ratni az √©rt√©keket
- Egyszerre figyelni IR √©s ultrahangos m√©r√©st, √©s √∂sszehasonl√≠tani
- Hangsz√≥r√≥ figyelmeztet√©s, ha t√∫l k√∂zel van valami
- OLED grafikon a t√°vols√°gv√°ltoz√°sr√≥l
